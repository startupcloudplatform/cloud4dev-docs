
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>MSA Technical Report · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="openapi_manager.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">개요</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    개발지원플랫폼 소개
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">오픈데이터API 활용 가이드</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="openapi_v2.html">
            
                <a href="openapi_v2.html#회원가입">
            
                    
                    회원가입
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="openapi_v2.html">
            
                <a href="openapi_v2.html#오픈데이터-api-이용-방법">
            
                    
                    오픈데이터 API 이용 방법
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="openapi_v2.html">
            
                <a href="openapi_v2.html#오픈데이터-api-사용해보기">
            
                    
                    오픈데이터 API 사용해보기
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="openapi_v2.html">
            
                <a href="openapi_v2.html#오픈데이터-api-테스트">
            
                    
                    오픈데이터 API 테스트
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="openapi_v2.html">
            
                <a href="openapi_v2.html#오픈데이터-api-이용-방법">
            
                    
                    활용실습-오픈데이터마켓 활용 실습
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.5.1" data-path="openapi_v2.html">
            
                <a href="openapi_v2.html#googlemap-api-권한">
            
                    
                    GoogleMap API 권한
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5.2" data-path="openapi_v2.html">
            
                <a href="openapi_v2.html#오픈데이터-api-주소-얻기">
            
                    
                    오픈데이터 API 주소 얻기
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5.3" data-path="openapi_v2.html">
            
                <a href="openapi_v2.html#실습-최종-결과물">
            
                    
                    최종결과물
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="openapi_v2.html">
            
                <a href="openapi_v2.html#두번째-실습-자료">
            
                    
                    활용실습.서울시 문화행사 API 호출 실습
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.6.1" data-path="openapi_v2.html">
            
                <a href="openapi_v2.html#두번째-실습-자료">
            
                    
                    Postman 실행
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6.2" data-path="openapi_v2.html">
            
                <a href="openapi_v2.html#서울시-문화행사-정보-api-신청">
            
                    
                    서울시문화행사정보 API신청
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6.3" data-path="openapi_v2.html">
            
                <a href="openapi_v2.html#서울시-문화행사정보-api-결과">
            
                    
                    서울시문화행사정보 API 결과
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">마이크로서비스 스튜디오 활용 가이드</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="MicroserviceGuide.html">
            
                <a href="MicroserviceGuide.html#마이크로서비스-스튜디오-개요">
            
                    
                    마이크로서비스 스튜디오 개요
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="MicroserviceGuide.html">
            
                <a href="MicroserviceGuide.html#마이크로서비스-스튜디오-주요-기능">
            
                    
                    마이크로서비스 스튜디오 주요 기능
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="MicroserviceGuide.html">
            
                <a href="MicroserviceGuide.html#백엔드앱-개발">
            
                    
                    백엔드앱 개발
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="MicroserviceGuide.html">
            
                <a href="MicroserviceGuide.html#프론트엔드-앱-개발">
            
                    
                    프론트엔드 앱 개발
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="paasta.html">
            
                <a href="paasta.html">
            
                    
                    PaaS-TA에 앱 배포하기
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="MicroserviceGuide.html">
            
                <a href="MicroserviceGuide.html#마이크로서비스-앱-구성">
            
                    
                    마이크로서비스 앱 구성
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.7" >
            
                <span>
            
                    
                    활용 사례
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.7.1" data-path="msacasestudy1.html">
            
                <a href="msacasestudy1.html">
            
                    
                    사례1-서울시문화공간 통합검색
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.7.2" data-path="msa_aptprice.html">
            
                <a href="msa_aptprice.html">
            
                    
                    사례2-지도상에 공동주택공시가격 제공
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.7.3" data-path="msa_fdservice.html">
            
                <a href="msa_fdservice.html">
            
                    
                    사례3-통합대기환경정보제공
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">마이크로서비스 기반 개발 가이드</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="msaspringcloud.html">
            
                <a href="msaspringcloud.html#스프링클라우드-적용-가이드">
            
                    
                    Microservice & Spring Cloud
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="swprocess.html">
            
                <a href="swprocess.html#마이크로서비스-아키텍처-기반-개발-개요">
            
                    
                    개요
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="swprocess.html">
            
                <a href="swprocess.html#마이크로서비스-아키텍처-설계-지침">
            
                    
                    마이크로서비스 아키텍처 설계 지침
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3" data-path="swprocess.html">
            
                <a href="swprocess.html#마이크로서비스-아키텍처-패턴">
            
                    
                    마이크로서비스 아키텍처 패턴
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.4" data-path="swprocess.html">
            
                <a href="swprocess.html#데이터-분산을-위한-데이터베이스-패턴">
            
                    
                    데이터 분산을 위한 데이터베이스 패턴
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.5" data-path="swprocess.html">
            
                <a href="swprocess.html#마이크로서비스-아키텍처-구현-방법">
            
                    
                    구현 방법
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.6" data-path="swprocess.html">
            
                <a href="swprocess.html#12-factor-방법">
            
                    
                    12 Factor 방법
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.7" data-path="msaspringcloud.html">
            
                <a href="msaspringcloud.html#스프링클라우드-적용-가이드">
            
                    
                    Microservice & Spring Cloud
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.8" data-path="msaspringcloud.html">
            
                <a href="msaspringcloud.html#spring-cloud-config-server">
            
                    
                    Spring Cloud Config Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.9" data-path="msaspringcloud.html">
            
                <a href="msaspringcloud.html#service-discovery-and-registry">
            
                    
                    Service Discovery and Registry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.10" data-path="msaspringcloud.html">
            
                <a href="msaspringcloud.html#api-gateway">
            
                    
                    API Gateway
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">개발지원 플랫폼 메뉴얼</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="msamanual_v2.html">
            
                <a href="msamanual_v2.html">
            
                    
                    마이크로서비스 스튜디오 사용자 메뉴얼
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.1" data-path="msamanual_v2.html">
            
                <a href="msamanual_v2.html#마이크로서비스-스튜디오-아키텍처">
            
                    
                    마이크로서비스 스튜디오 아키텍처
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2" data-path="msamanual_v2.html">
            
                <a href="msamanual_v2.html#마이크로서비스-스튜디오-시작하기">
            
                    
                    마이크로서비스 스튜디오 시작하기
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.3" data-path="msamanual_v2.html">
            
                <a href="msamanual_v2.html#마이크로서비스-생성하기">
            
                    
                    마이크로서비스 생성
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.4" data-path="msamanual_v2.html">
            
                <a href="msamanual_v2.html#마이크로서비스-조회-및-수정">
            
                    
                    마이크로서비스 조회 및 수정
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.5" data-path="msamanual_v2.html">
            
                <a href="msamanual_v2.html#rest-api-테스트-기능">
            
                    
                    REST API 테스트 기능
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.6" data-path="msamanual_v2.html">
            
                <a href="msamanual_v2.html#api-관리">
            
                    
                    API 관리
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="openapi.html">
            
                <a href="openapi.html">
            
                    
                    오픈데이터API 사용자 메뉴얼
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="openapi_manager.html">
            
                <a href="openapi_manager.html">
            
                    
                    오픈데이터API 제공처 메뉴얼
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">마이크로서비스 스튜디오 기술문서</li>
        
        
    
        <li class="chapter active" data-level="6.1" data-path="Technical_Report.html">
            
                <a href="Technical_Report.html">
            
                    
                    MSA Technical Report
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >MSA Technical Report</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="technical-report">Technical Report</h1>
<h4 id="&#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC11C;&#xBE44;&#xC2A4;-&#xC2A4;&#xD29C;&#xB514;&#xC624;-&#xC124;&#xCE58;&#xD558;&#xAE30;"><a href="#&#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC11C;&#xBE44;&#xC2A4;-&#xC2A4;&#xD29C;&#xB514;&#xC624;-&#xC124;&#xCE58;">&#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC11C;&#xBE44;&#xC2A4; &#xC2A4;&#xD29C;&#xB514;&#xC624; &#xC124;&#xCE58;&#xD558;&#xAE30;</a></h4>
<blockquote>
<h5 id="iaas-&#xAD6C;&#xC131;--azure-"><a href="##iaas-&#xAD6C;&#xC131;-azure-">IaaS &#xAD6C;&#xC131; ( Azure )</a></h5>
<h5 id="bosh-&#xC124;&#xCE58;&#xD558;&#xAE30;"><a href="#bosh-deploying">Bosh &#xC124;&#xCE58;&#xD558;&#xAE30;</a></h5>
<h5 id="cloudfoundry-&#xC124;&#xCE58;&#xD558;&#xAE30;"><a href="#cloudfoundry-&#xC124;&#xCE58;">CloudFoundry &#xC124;&#xCE58;&#xD558;&#xAE30;</a></h5>
<h5 id="msxpert-&#xC124;&#xCE58;&#xD558;&#xAE30;"><a href="#msxpert-&#xC124;&#xCE58;">MsXpert &#xC124;&#xCE58;&#xD558;&#xAE30;</a></h5>
<h4 id="msxpert-&#xC6B4;&#xC601;"><a href="#&#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC11C;&#xBE44;&#xC2A4;-&#xC2A4;&#xD29C;&#xB514;&#xC624;-&#xC6B4;&#xC601;">MsXpert &#xC6B4;&#xC601;</a></h4>
<h5 id="trouble-shooting"><a href="#trouble-shooting">Trouble Shooting</a></h5>
<h4 id="references"><a href="#msxpert-reference">References</a></h4>
<h5 id="database-&#xAD6C;&#xC870;"><a href="#database-&#xAD6C;&#xC870;">Database &#xAD6C;&#xC870;</a></h5>
</blockquote>
<hr>
<h3 id="&#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC11C;&#xBE44;&#xC2A4;-&#xC2A4;&#xD29C;&#xB514;&#xC624;-&#xC124;&#xCE58;">&#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC11C;&#xBE44;&#xC2A4; &#xC2A4;&#xD29C;&#xB514;&#xC624; &#xC124;&#xCE58;</h3>
<h4 id="iaas-&#xAD6C;&#xC131;-azure-">IaaS &#xAD6C;&#xC131;( Azure )</h4>
<h5 id="1-1---&#xB9AC;&#xC18C;&#xC2A4;-&#xADF8;&#xB8F9;-&#xC0DD;&#xC131;">1-1 .  &#xB9AC;&#xC18C;&#xC2A4; &#xADF8;&#xB8F9; &#xC0DD;&#xC131;</h5>
<p> <img src="technicalReportImages/Azure_resouceGroup_Create.png" alt=""></p>
<h5 id="1-2---application-&#xB4F1;&#xB85D;">1-2 .  Application &#xB4F1;&#xB85D;</h5>
<ul>
<li><p>Active Directory&#xC5D0;&#xC11C; Application &#xB4F1;&#xB85D;
 <img src="technicalReportImages/Azure_App_registration.png" alt=""></p>
</li>
<li><p>&#xC0DD;&#xC131;&#xD55C; Application&#xC758; secret &#xC0DD;&#xC131;
 <img src="technicalReportImages/Azure_App_secret.png" alt=""></p>
</li>
<li><p>&#xC0DD;&#xC131;&#xD55C; Application&#xC744; Azure Subscription&#xC758; Contributer&#xB85C; &#xAD8C;&#xD55C; &#xBD80;&#xC5EC;
 <img src="technicalReportImages/Azure_assign_role_to_application.png" alt=""></p>
</li>
<li><p>&#xC0DD;&#xC131;&#xD55C; Resource Group&#xC5D0; &#xC0AC;&#xC6A9;&#xD558;&#xACE0;&#xC790; &#xD558;&#xB294; User&#xB97C; Contributer&#xB85C; &#xB4F1;&#xB85D; 
 <img src="technicalReportImages/Azure_assign_User_Role.png" alt=""></p>
</li>
</ul>
<h5 id="1-3---storage-account-&#xC0DD;&#xC131;">1-3 .  Storage Account &#xC0DD;&#xC131;</h5>
<ul>
<li><p>Azure&#xC758; Log&#xB97C; &#xAE30;&#xB85D;&#xD558;&#xB294; &#xACF3; 
<img src="technicalReportImages/Azure_storage_account_create.png" alt=""></p>
</li>
<li><p>&#xCEE8;&#xD14C;&#xC774;&#xB108; &#xC0DD;&#xC131;
<img src="technicalReportImages/Azure_container_create.png" alt=""></p>
</li>
<li><p>&#xD14C;&#xC774;&#xBE14; &#xC0DD;&#xC131;
<img src="technicalReportImages/Azure_tables_create.png" alt=""></p>
</li>
</ul>
<h5 id="1-4---&#xB124;&#xD2B8;&#xC6CC;&#xD06C;-&#xAD6C;&#xC131;">1-4 .  &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xAD6C;&#xC131;</h5>
<ol>
<li><p>NSG(Network Security Group) &#xAD6C;&#xC131;
<em>8080, 443, 80, 8082, 9088&#xD3EC;&#xD2B8;&#xB294; msxpert&#xC5D0; &#xB530;&#xB85C; &#xC801;&#xC6A9;&#xC744; &#xC704;&#xD574; &#xB4F1;&#xB85D;&#xD55C; port</em>
<img src="technicalReportImages/Azure_network_security_group.png" alt=""></p>
<p>CloudFoundry &#xC124;&#xCE58;&#xC5D0; &#xD544;&#xC694;&#xD55C; port&#xAD00;&#xB828; &#xC0AC;&#xD56D;: <a href="https://github.com/cloudfoundry/bosh-deployment" target="_blank">https://github.com/cloudfoundry/bosh-deployment</a>
<img src="technicalReportImages/Azure_bosh_install_security_group.png" alt=""></p>
</li>
</ol>
<ol>
<li><p>&#xAC00;&#xC0C1; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xAD6C;&#xC131;</p>
<ul>
<li><p>Address Space</p>
<p><img src="technicalReportImages/Azure_Virtual_network.png" alt=""></p>
</li>
<li><p>Subnets</p>
<p><img src="technicalReportImages/Azure_virtual_network_subnets.png" alt=""></p>
</li>
</ul>
</li>
<li><p>Route Table &#xAD6C;&#xC131; - route table &#xC0DD;&#xC131; &#xD6C4; bosh-net &#xC11C;&#xBE0C;&#xB137; &#xD560;&#xB2F9;
 <img src="technicalReportImages/Azure_route_tables.png" alt=""></p>
</li>
</ol>
<h5 id="1-5--vm-&#xC0DD;&#xC131;-bosh-inception">1-5 . vm &#xC0DD;&#xC131; (bosh-inception)</h5>
<p>   <img src="technicalReportImages/Azure_vm_create.png" alt=""></p>
<h4 id="bosh-deploying">Bosh Deploying</h4>
<h5 id="2-1--bosh-cli-&#xC124;&#xCE58;">2-1 . bosh-cli &#xC124;&#xCE58;</h5>
<pre><code class="lang-shell">    # &#xB2E4;&#xC6B4; &#xBC1B;&#xC740; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xD30C;&#xC77C;&#xC744; /usr/local/bin&#xD3F4;&#xB354; &#xC544;&#xB798;&#xC5D0; &#xC704;&#xCE58;&#xC2DC;&#xD0A4;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xC124;&#xCE58; &#xC644;&#xB8CC;
    $ wget https://github.com/cloudfoundry/bosh-cli/releases/download/v6.2.1/bosh-cli-6.2.1-linux-amd64
    $ chmod +x ./bosh-cli-6.2.1-linux-amd64
    $ sudo mv ./bosh-cli-6.2.1-linux-amd64 /usr/local/bin/bosh
</code></pre>
<h5 id="2-2--bosh-deploy">2-2 . bosh deploy</h5>
<pre><code class="lang-shell">      # bosh deploy &#xC804; &#xC0AC;&#xC804; &#xC900;&#xBE44; &#xC791;&#xC5C5;
      $ sudo apt-get update
      $ sudo apt-get install -y build-essential zlibc zlib1g-dev ruby ruby-dev openssl libxslt-dev libxml2-dev libssl-dev libreadline6 libreadline6-dev libyaml-dev libsqlite3-dev sqlite

      # bosh-deploy clone
      $ git clone https://github.com/cloudfoundry/bosh-deployment.git

      # Deploy Bosh &#xC608;&#xC2DC; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;
      #!/bin/bash

      $ bosh create-env ~/workspace/bosh/bosh-deployment/bosh.yml \
          --state=state.json \
          --vars-store=creds.yml \
          -o bosh-deployment/azure/cpi.yml \
          -o bosh-deployment/uaa.yml \
          -o bosh-deployment/jumpbox-user.yml \
          -v director_name=bosh \
          -v internal_cidr=192.168.0.0/24 \ # Azure&#xC5D0;&#xC11C; bosh&#xC6A9;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD55C; subnet address-space
          -v internal_gw=192.168.0.1 \
          -v internal_ip=192.168.0.6 \
          -v vnet_name=msxpertfin \ # Azure&#xC5D0;&#xC11C; &#xC0DD;&#xC131;&#xD55C; Virtual Network
          -v subnet_name=bosh-net \ # Azure&#xC5D0;&#xC11C; bosh&#xC6A9;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD55C; subnet &#xC774;&#xB984;
          -v subscription_id=ff38~~~~~~~~~~~~~~~~~~~~~~~~~~ \ # &#xC0AC;&#xC6A9;&#xD560; Azure subscription ID
          -v tenant_id=8be9~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ \ # &#xC0AC;&#xC6A9;&#xD560; Azure App DirectoryID
          -v client_id=383b~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ \ # &#xC0AC;&#xC6A9;&#xD560; Azure App Client ID
          -v client_secret=6hs8i~~~~~~~~~~~~~~~~~~~~~~~~~~~ \ # &#xC0AC;&#xC6A9;&#xD560; Azure App Secret ID
          -v resource_group_name=msxpert_fin \ # Azure resource Group &#xC774;&#xB984;
          -v storage_account_name=msxpertfin \ # Azure storage-account &#xC774;&#xB984;
          -v default_security_group=msxpert-fin-secure # Azure NSG &#xC774;&#xB984;
</code></pre>
<h5 id="2-3-bosh-target-&#xC124;&#xC815;">2-3. bosh target &#xC124;&#xC815;</h5>
<pre><code class="lang-shell">      # target &#xC124;&#xC815; &#xBC0F; &#xB85C;&#xADF8;&#xC778;
      #!/bin/bash

      # Configure local alias
      $ bosh alias-env [&#xC9C0;&#xC815;&#xD560; &#xC774;&#xB984;] -e [Deploy -- Internal_IP] --ca-cert &lt;(bosh int [Deploy -- creds.yml &#xD30C;&#xC77C; &#xACBD;&#xB85C; ]/creds.yml --path /director_ssl/ca)

      # Log in to the Director
      $ export BOSH_CLIENT=admin
      $ export BOSH_CLIENT_SECRET=`bosh int [Deploy -- creds.yml &#xD30C;&#xC77C; &#xACBD;&#xB85C;]/creds.yml --path /admin_password`

      # Query the Director for more info
      $ echo $BOSH_CLIENT_SECRET
      $ bosh -e bosh env
      $ bosh -e bosh login
</code></pre>
<h4 id="cloudfoundry-&#xC124;&#xCE58;">CloudFoundry &#xC124;&#xCE58;</h4>
<h5 id="3-1-upload-a-cloud-config">3-1. Upload a Cloud-Config</h5>
<pre><code class="lang-shell">      $ bosh -e [target &#xC124;&#xC815;&#xC2DC; &#xC9C0;&#xC815;&#xD55C; &#xC774;&#xB984;] ucc iaas-support/azure/cloud-config.yml
</code></pre>
<h5 id="3-2-runtime-config-upload">3-2. <del>Runtime-config Upload</del></h5>
<h5 id="3-3-upload-a-stemcell">3-3. Upload a Stemcell</h5>
<pre><code class="lang-shell">       $ bosh -e bosh upload-stmecell [&#xC124;&#xCE58; &#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xD560; stemcell]
</code></pre>
<h5 id="3-4-deploy-cf">3-4. Deploy CF</h5>
<pre><code class="lang-shell">      #!/bin/bash

      $ bosh -e bosh -d cf deploy cf-deployment/cf-deployment.yml \
        --vars-store=./env-repo/deployment-vars.yml \
        -v system_domain=paastaxxxxx.co.kr \ # &#xC0AC;&#xC6A9;&#xD560; Domain
        -v haproxy_public_network_name=vip \ # &#xC0AC;&#xC6A9;&#xD560; haproxy_public_network &#xC774;&#xB984;
        -v haproxy_public_ip=[xxx.xxx.xxx.xxx] \ # IaaS&#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xD55C; Public IP
        -o cf-deployment/operations/use-postgres.yml \
        -o cf-deployment/operations/azure.yml \
        -o cf-deployment/operations/use-haproxy.yml \
        -o cf-deployment/operations/use-haproxy-public-network.yml
</code></pre>
<h4 id="msxpert-&#xC124;&#xCE58;">MsXpert &#xC124;&#xCE58;</h4>
<h5 id="4-1-angularcli-&#xC124;&#xCE58;">4-1. angular/cli &#xC124;&#xCE58;</h5>
<pre><code class="lang-shell">      $ curl -sL https://deb.nodesource.com/setup_8.x | sudo -E bash -
      $ sudo apt-get install -y nodejs
      $ npm install -g @angular/cli@1.6.7

      # npm install &#xBA85;&#xB839;&#xC5B4; &#xC2E4;&#xD589;&#xC2DC; sudo npm install&#xC740; &#xAD8C;&#xC7A5;&#xD558;&#xC9C0; &#xC54A;&#xC74C;.
      # -g: global &#xC635;&#xC158;&#xC73C;&#xB85C; &#xC124;&#xCE58;&#xC2DC; &#xBC1C;&#xC0DD;&#xD558;&#xB294; permission &#xBB38;&#xC81C;&#xB294; https://docs.npmjs.com/resolving-eacces-permissions-errors-when-installing-packages-globally &#xCC38;&#xC870;

      # ~/.profile &#xD30C;&#xC77C;&#xC5D0;&#xC11C; PATH&#xBCC0;&#xC218;&#xC5D0; node_modules &#xD3F4;&#xB354; &#xC544;&#xB798;&#xC758; @angular/cli/bin &#xD3F4;&#xB354;&#xB97C; &#xB4F1;&#xB85D;
      # node_modules &#xD3F4;&#xB354;&#xC758; &#xC704;&#xCE58;&#xC5D0; &#xB530;&#xB77C; &#xC801;&#xC808;&#xD558;&#xAC8C; PATH&#xAC12; &#xB4F1;&#xB85D;
      # source ~/.profile &#xBA85;&#xB839;&#xC744; &#xD1B5;&#xD574; PATH&#xC801;&#xC6A9;
      # &#xC608;&#xC2DC; export PATH=$PATH:/home/[linux&#xC720;&#xC800;ID]/.npm/node_modules/@angular/cli/bin
</code></pre>
<h5 id="4-2-nodemodule-&#xC124;&#xCE58;">4-2. node_module &#xC124;&#xCE58;</h5>
<pre><code class="lang-shell">      # git clone &#xC744; &#xD1B5;&#xD574; MsXpert &#xD504;&#xB85C;&#xC81D;&#xD2B8; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;
      $ cd microservice/src/crossent/micro/studio/web
      $ npm install
</code></pre>
<h5 id="4-3-golang-&#xC124;&#xCE58;go-install-go-bindata">4-3. golang &#xC124;&#xCE58;(go install go-bindata)</h5>
<pre><code class="lang-shell">      # golang 1.9.7&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;
      $ wget https://dl.google.com/go/go1.9.7.linux-amd64.tar.gz

      # /usr/local&#xACBD;&#xB85C; &#xC544;&#xB798;&#xC5D0; golang &#xC555;&#xCD95;&#xD480;&#xAE30;
      $ sudo tar -C /usr/local -xzf go1.9.7.linux-amd64.tar.gz

      # ~/.profile &#xC5D0;&#xC11C; PATH &#xB4F1;&#xB85D;&#xD558;&#xAE30;
      # export PATH=$PATH:/usr/local/go/bin
      $ vi ~/.profile
      $ source ~/.profile

      # git clone [MsXpert Studio] 
      # cd [ project folder ]
      $ cd microservice
      $ export GOPATH=$PWD
      $ export PATH=$PWD/bin:$PATH
      $ go install vendor/github.com/jteeuwen/go-bindata/go-bindata
</code></pre>
<h5 id="4-4-api-&#xC11C;&#xBC84;-&#xC8FC;&#xC18C;-&#xD655;&#xC778;">4-4. API &#xC11C;&#xBC84; &#xC8FC;&#xC18C; &#xD655;&#xC778;</h5>
<pre><code class="lang-shell">      $ vi microservice/src/crossent/micro/studio/web/src/environments/environment.prod.ts
      # &#xC608;&#xC2DC;
      # msxpert portal&#xC5D0; &#xD560;&#xB2F9;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0DD;&#xC131;&#xD574; &#xB193;&#xC740; public IP : 101.101.XXX.XXX
      # IaaS&#xC601;&#xC5ED;&#xC5D0;&#xC11C; &#xC124;&#xC815;&#xD574;&#xB454; IP&#xC640; port&#xBC88;&#xD638;&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xC5EC; apiUrl, swaggerApiUrl &#xC791;&#xC131;
      export const environment = {
        production: true,
        apiUrl: &apos;http://101.101.XXX.XXX:8080/api/v1&apos;,  
        swaggerApiUrl: &apos;http://101.101.XXX.XXX:8080/swagger/&apos;,
        cfEnvNameMSA: &apos;msa&apos;,
        cfEnvNamePrivate: &apos;private&apos;,
        msServices: &apos;config-server,registry-server,gateway-server&apos;,
        sampleApps: &apos;front,back&apos;,
        nodeTypeApp: &apos;App&apos;,
        nodeTypeService: &apos;Service&apos;,
        configService: &apos;config-server&apos;,
        registryService: &apos;registry-server&apos;,
        configServiceLabel: &apos;micro-config-server&apos;,
        registryServiceLabel: &apos;micro-registry-server&apos;
      };
</code></pre>
<h5 id="4-5-web-binary-&#xC0DD;&#xC131;">4-5. Web Binary &#xC0DD;&#xC131;</h5>
<pre><code class="lang-shell">      $ cd microservice/src/crossent/micro/studio
      $ make
</code></pre>
<h5 id="4-6-spring-cloud-application-&#xC900;&#xBE44;">4-6. Spring-Cloud Application &#xC900;&#xBE44;</h5>
<pre><code class="lang-shell">      # https://github.com/startupcloudplatform/Microservices/releases &#xC5D0;&#xC11C; 
      # - config-0.0.1-SNAPSHOT.jar
      # - gateway-0.0.1-SNAPSHOT.jar
      # - registry-0.0.1-SNAPSHOT.jar
      # 3&#xAC1C;&#xC758; jar&#xD30C;&#xC77C;&#xC744; &#xB2E4;&#xC6B4; &#xBC1B;&#xC544;&#xC11C; &#xAC01; &#xD3F4;&#xB354;&#xC5D0; &#xC704;&#xCE58;&#xC2DC;&#xCF1C;&#xC57C;&#xD568;.

      $ cp config-0.0.1-SNAPSHOT.jar microservice/src/crossent/micro/broker/config/assets/configapp

      $ cp registry-0.0.1-SNAPSHOT.jar microservice/src/crossent/micro/broker/config/assets/registryapp

      $ cp gateway-0.0.1-SNAPSHOT.jar microservice/src/crossent/micro/broker/config/assets/gatewayapp
</code></pre>
<h5 id="4-7-blob-&#xC900;&#xBE44;">4-7. Blob &#xC900;&#xBE44;</h5>
<pre><code class="lang-shell">
        $ cf microservice
        $ bosh add-blob golang-linux-amd64-1.8.3.tar.gz golang/golang-linux-amd64-1.8.3.tar.gz
        $ bosh add-blob jq-linux64-1.5 jq/jq-linux64-1.5
        $ bosh add-blob grafana-5.3.4.linux-x64.tar.gz grafana/grafana-5.3.4.linux-x64.tar.gz
        $ bosh add-blob nginx-1.10.3.tar.gz nginx/nginx-1.10.3.tar.gz
        $ bosh add-blob binary/pcre-8.42.tar.gz nginx/pcre-8.42.tar.gz
        $ bosh add-blob prometheus-2.5.0.linux-amd64.tar.gz prometheus/prometheus-2.5.0.linux-amd64.tar.gz
        $ bosh add-blob traefik-1.6.5_linux-amd64.gz traefik/traefik-1.6.5_linux-amd64.gz
</code></pre>
<h5 id="4-8-cf-org-space-&#xC0DD;&#xC131;">4-8. CF org, space &#xC0DD;&#xC131;</h5>
<pre><code class="lang-shell">      # cf-cli &#xC124;&#xCE58;
      $ curl -L &quot;https://cli.run.pivotal.io/stable?release=linux64-binary&quot; | tar -zx
      $ sudo cp cf /usr/local/bin/
      $ cf --version

      $ cf create-org org-micro
      $ cf create-space space-micro -o org-micro
</code></pre>
<h5 id="4-9-uaa-client-&#xB4F1;&#xB85D;">4-9. UAA Client &#xB4F1;&#xB85D;</h5>
<pre><code class="lang-shell">      # cf-uaac &#xC124;&#xCE58;
      $ gpg --keyserver hkp://pool.sks-keyservers.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3 7D2BAF1CF37B13E2069D6956105BD0E739499BDB
      $ \curl -sSL https://get.rvm.io | bash -s stable
      $ source ~/.rvm/scripts/rvm
      $ rvm install ruby-2.3.0
      $ gem install cf-uaac

      # cf-uaac target &#xC124;&#xC815;
      ## bosh-lite.com &#xBD80;&#xBD84;&#xC740; &#xC0C1;&#xD669;&#xC5D0; &#xB9DE;&#xAC8C; Domain&#xC744; &#xB123;&#xC5B4;&#xC918;&#xC57C;&#xD568;.
      $ uaac target https://uaa.bosh-lite.com --skip-ssl-validation
      $ uaac token client get admin -s [cf &#xC124;&#xCE58;&#xC2DC; &#xC0DD;&#xC131;&#xB41C; uaa_admin_client_secret]

      $ uaac client add micro --name micro -s micro-secret \
         --authorities &quot;oauth.login,scim.write,clients.read,scim.userids,password.write,clients.secret,clients.write,uaa.admin,scim.read,doppler.firehose&quot; \
         --authorized_grant_types &quot;authorization_code,client_credentials,password,refresh_token&quot; \
         --scope &quot;cloud_controller.read,cloud_controller.write,openid,cloud_controller.admin,scim.read,scim.write,doppler.firehose,uaa.user,routing.router_groups.read,uaa.admin,password.write&quot; \
         --redirect_uri &quot;https://uaa.bosh-lite.com/login&quot;
</code></pre>
<h5 id="4-10-deploy-msxpert">4-10. Deploy MsXpert</h5>
<pre><code class="lang-shell">       $ cd microservice
       $ bosh -e vbox update-cloud-config cloud-config.yml
       $ bosh -e vbox create-release --name msxpert-nipa --force
       $ bosh -e vbox upload-release --name msxpert-nipa
       $ bosh -e vbox -d msxpert-nipa deploy microservice-msxpert.yml --vars-file vars-file.yml
       # vars-file.yml &#xC608;&#xC2DC;
        ---
        cf_api_url: https://api.[Domain &#xC8FC;&#xC18C;]
        uaa_url: https://uaa.[Domain &#xC8FC;&#xC18C;]
        cf_username: admin
        cf_password: [cf_admin_password]
        cf_skip_cert_check: true
        external_url: http:[IaaS&#xC5D0;&#xC11C; &#xC124;&#xC815;&#xD55C; studio public IP &#xBC0F; port&#xBC88;&#xD638;] 
        # &#xBB38;&#xC11C; 4-4&#xC5D0;&#xC11C; apiUrl&#xC5D0; &#xB123;&#xC5B4;&#xC900; IP:port&#xC640; &#xB3D9;&#xC77C;
        haproxy_backend_port: 8089
        grafana_admin_password: admin

       $ bosh -e vbox -d msxpert-nipa run-errand broker-registrar
</code></pre>
<p>  &lt; cloud-config.yml &#xC608;&#xC2DC; &gt;</p>
<pre><code class="lang-yaml"><span class="hljs-attr">       azs:</span>
<span class="hljs-attr">       - name:</span> z1
<span class="hljs-attr">       - name:</span> z2
<span class="hljs-attr">       - name:</span> z3

<span class="hljs-attr">       vm_types:</span>
<span class="hljs-attr">       - name:</span> small
<span class="hljs-attr">         cloud_properties:</span>
<span class="hljs-attr">           instance_type:</span> Standard_A1_v2
<span class="hljs-attr">       - name:</span> medium
<span class="hljs-attr">         cloud_properties:</span>
<span class="hljs-attr">           instance_type:</span> Standard_A2_v2
<span class="hljs-attr">       - name:</span> large
<span class="hljs-attr">         cloud_properties:</span>
<span class="hljs-attr">           instance_type:</span> Standard_A4_v2
<span class="hljs-attr">       - name:</span> xlarge
<span class="hljs-attr">         cloud_properties:</span>
<span class="hljs-attr">           instance_type:</span> Standard_D4s_v3

<span class="hljs-attr">       disk_types:</span>
<span class="hljs-attr">       - name:</span> default
<span class="hljs-attr">         disk_size:</span> <span class="hljs-number">3000</span>
<span class="hljs-attr">       - name:</span> small
<span class="hljs-attr">         disk_size:</span> <span class="hljs-number">5000</span>
<span class="hljs-attr">       - name:</span> medium
<span class="hljs-attr">         disk_size:</span> <span class="hljs-number">10000</span>
<span class="hljs-attr">       - name:</span> large
<span class="hljs-attr">         disk_size:</span> <span class="hljs-number">50</span>_000
<span class="hljs-attr">       - name:</span> xlarge
<span class="hljs-attr">         disk_size:</span> <span class="hljs-number">100</span>_000

<span class="hljs-attr">       networks:</span>
<span class="hljs-attr">       - name:</span> default
<span class="hljs-attr">         type:</span> manual
<span class="hljs-attr">         subnets:</span>
<span class="hljs-attr">         - range:</span> <span class="hljs-number">192.168</span><span class="hljs-number">.10</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span> <span class="hljs-comment"># &#xB0B4;&#xBD80;&#xB9DD;</span>
<span class="hljs-attr">           gateway:</span> <span class="hljs-number">192.168</span><span class="hljs-number">.10</span><span class="hljs-number">.1</span>
<span class="hljs-attr">           azs:</span> [z1, z2, z3]
<span class="hljs-attr">           dns:</span> [<span class="hljs-number">8.8</span><span class="hljs-number">.8</span><span class="hljs-number">.8</span>]
<span class="hljs-attr">           reserved:</span> <span class="hljs-number">192.168</span><span class="hljs-number">.10</span><span class="hljs-number">.2</span><span class="hljs-bullet">-192.168</span><span class="hljs-number">.10</span><span class="hljs-number">.100</span> <span class="hljs-comment"># &#xC774;&#xBBF8; &#xC0AC;&#xC6A9;&#xC911;&#xC778; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;</span>
       <span class="hljs-comment">#    static: ((static_ips))</span>
<span class="hljs-attr">           cloud_properties:</span>
<span class="hljs-attr">             virtual_network_name:</span> msxpertfin <span class="hljs-comment"># network-toplogy &#xC0AC;&#xC9C4; &#xCC38;&#xACE0; </span>
<span class="hljs-attr">             subnet_name:</span> cf-net <span class="hljs-comment"># network-toplogy &#xC0AC;&#xC9C4; &#xCC38;&#xACE0;</span>
<span class="hljs-attr">             security_group:</span> msxpert-fin-secure <span class="hljs-comment"># network-toplogy &#xC0AC;&#xC9C4; &#xCC38;&#xACE0;</span>

<span class="hljs-attr">       - name:</span> vip <span class="hljs-comment"># cf &#xBC30;&#xD3EC;&#xC2DC; haproxy_public_network_name</span>
<span class="hljs-attr">         type:</span> vip

<span class="hljs-attr">       compilation:</span>
<span class="hljs-attr">         workers:</span> <span class="hljs-number">5</span>
<span class="hljs-attr">         reuse_compilation_vms:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">         az:</span> z1
<span class="hljs-attr">         vm_type:</span> medium
<span class="hljs-attr">         network:</span> default
</code></pre>
<ul>
<li><p>range == cf-subnet --------------------------------------------------------------------------------------------------------------
   <img src="technicalReportImages/bosh-cf-subnet.png" alt=""></p>
</li>
<li><p>network-toplogy ---------------------------------------------------------------------------------------------------------------
   <img src="technicalReportImages/network-toplogy.png" alt=""></p>
<p>&lt; microservice-msxpert.yml  &#xC608;&#xC2DC; &gt;</p>
<pre><code class="lang-yaml"><span class="hljs-bullet">   -</span>--
<span class="hljs-attr">   name:</span> msxpert-nipa

<span class="hljs-attr">   releases:</span>
<span class="hljs-attr">   - name:</span> msxpert-nipa
<span class="hljs-attr">     version:</span> latest
<span class="hljs-attr">   - name:</span> postgres
<span class="hljs-attr">     version:</span> <span class="hljs-number">23</span>
<span class="hljs-attr">     url:</span> https://bosh.io/d/github.com/cloudfoundry/postgres-release?v=<span class="hljs-number">23</span>
<span class="hljs-attr">     sha1:</span> <span class="hljs-number">4</span>b5265bfd5f92cf14335a75658658a0db0bca927
<span class="hljs-attr">   - name:</span> haproxy
<span class="hljs-attr">     version:</span> <span class="hljs-number">9.3</span><span class="hljs-number">.0</span>
<span class="hljs-attr">     url:</span> https://github.com/cloudfoundry-incubator/haproxy-boshrelease/releases/download/v9<span class="hljs-number">.3</span><span class="hljs-number">.0</span>/haproxy<span class="hljs-bullet">-9.3</span><span class="hljs-number">.0</span>.tgz
<span class="hljs-attr">     sha1:</span> <span class="hljs-number">384</span>de4ad378b940641a34cda1c63fdc02c901b8f

<span class="hljs-attr">   stemcells:</span>
<span class="hljs-attr">   - alias:</span> trusty
<span class="hljs-attr">     os:</span> ubuntu-trusty
<span class="hljs-attr">     version:</span> latest

<span class="hljs-attr">   instance_groups:</span>
<span class="hljs-attr">   - name:</span> studio-nipa
<span class="hljs-attr">     instances:</span> <span class="hljs-number">1</span>
<span class="hljs-attr">     vm_type:</span> small
<span class="hljs-attr">     vm_extensions:</span> []
<span class="hljs-attr">     stemcell:</span> trusty
<span class="hljs-attr">     azs:</span> [z1]
<span class="hljs-attr">     networks:</span> [{name: default}]
<span class="hljs-attr">     jobs:</span>
<span class="hljs-attr">     - name:</span> studio
<span class="hljs-attr">       release:</span> msxpert-nipa
<span class="hljs-attr">       properties:</span>
<span class="hljs-attr">         bind_ip:</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>
<span class="hljs-attr">         bind_port:</span> <span class="hljs-number">8080</span>
<span class="hljs-attr">         external_url:</span> ((external_url))
<span class="hljs-attr">         postgresql:</span>
<span class="hljs-attr">           database:</span> &amp;db_name microservice-nipa
<span class="hljs-attr">           role:</span> <span class="hljs-meta">&amp;db_role</span>
<span class="hljs-attr">             name:</span> microservice
<span class="hljs-attr">             password:</span> dummy-postgres-password
<span class="hljs-attr">         cf:</span>
<span class="hljs-attr">           api_url:</span> ((cf_api_url))
           uaa_url : ((uaa_url))
<span class="hljs-attr">           username:</span> ((cf_username))
<span class="hljs-attr">           password:</span> ((cf_password))
<span class="hljs-attr">           skip_cert_check:</span> ((cf_skip_cert_check))
<span class="hljs-attr">           client_id:</span> micro
<span class="hljs-attr">           client_secret:</span> micro-secret
<span class="hljs-attr">     - name:</span> microservice-broker
<span class="hljs-attr">       release:</span> msxpert-nipa
<span class="hljs-attr">       properties:</span>
<span class="hljs-attr">         broker:</span>
<span class="hljs-attr">           username:</span> admin
<span class="hljs-attr">           password:</span> admin
<span class="hljs-attr">           port:</span> <span class="hljs-number">3000</span>
<span class="hljs-attr">         cf:</span>
<span class="hljs-attr">           api:</span> ((cf_api_url))
<span class="hljs-attr">           username:</span> ((cf_username))
<span class="hljs-attr">           password:</span> ((cf_password))
<span class="hljs-attr">           organization:</span> org-micro
<span class="hljs-attr">           space:</span> space-micro
<span class="hljs-attr">           skip_cert_check:</span> ((cf_skip_cert_check))

<span class="hljs-attr">     - name:</span> haproxy
<span class="hljs-attr">       release:</span> haproxy
<span class="hljs-attr">       consumes:</span>
<span class="hljs-attr">         http_backend:</span> {from: haproxy_traefik}
<span class="hljs-attr">       properties:</span>
<span class="hljs-attr">         ha_proxy:</span>
<span class="hljs-attr">           backend_port:</span> ((haproxy_backend_port))

<span class="hljs-attr">     - name:</span> nginx
<span class="hljs-attr">       release:</span> msxpert-nipa

<span class="hljs-attr">   - name:</span> db-nipa
<span class="hljs-attr">     instances:</span> <span class="hljs-number">1</span>
<span class="hljs-attr">     vm_type:</span> small
<span class="hljs-attr">     stemcell:</span> trusty
<span class="hljs-attr">     persistent_disk_type:</span> small <span class="hljs-comment">#5GB</span>
<span class="hljs-attr">     azs:</span> [z1]
<span class="hljs-attr">     networks:</span> [{name: default}]
<span class="hljs-attr">     jobs:</span>
<span class="hljs-attr">     - name:</span> postgres
<span class="hljs-attr">       release:</span> postgres
<span class="hljs-attr">       properties:</span>
<span class="hljs-attr">         databases:</span>
<span class="hljs-attr">           port:</span> <span class="hljs-number">5432</span>
<span class="hljs-attr">           databases:</span>
<span class="hljs-attr">           - name:</span> <span class="hljs-meta">*db_name</span>
<span class="hljs-attr">           roles:</span>
<span class="hljs-bullet">           -</span> <span class="hljs-meta">*db_role</span>

<span class="hljs-attr">   - name:</span> broker-registrar-micro
<span class="hljs-attr">     instances:</span> <span class="hljs-number">1</span>
<span class="hljs-attr">     azs:</span> [z1]
<span class="hljs-attr">     lifecycle:</span> errand
<span class="hljs-attr">     vm_type:</span> small
<span class="hljs-attr">     stemcell:</span> trusty
<span class="hljs-attr">     networks:</span> [{name: default}]
<span class="hljs-attr">     jobs:</span>
<span class="hljs-attr">     - name:</span> broker-registrar
<span class="hljs-attr">       release:</span> msxpert-nipa
<span class="hljs-attr">       properties:</span>
<span class="hljs-attr">         servicebroker:</span>
<span class="hljs-attr">           name:</span> microservicebroker
<span class="hljs-attr">           username:</span> admin
<span class="hljs-attr">           password:</span> admin
<span class="hljs-attr">         cf:</span>
<span class="hljs-attr">           api_url:</span> ((cf_api_url))
<span class="hljs-attr">           username:</span> ((cf_username))
<span class="hljs-attr">           password:</span> ((cf_password))
<span class="hljs-attr">           skip_ssl_validation:</span> ((cf_skip_cert_check))

<span class="hljs-attr">   - name:</span> broker-deregistrar-micro
<span class="hljs-attr">     instances:</span> <span class="hljs-number">1</span>
<span class="hljs-attr">     azs:</span> [z1]
<span class="hljs-attr">     lifecycle:</span> errand
<span class="hljs-attr">     vm_type:</span> small
<span class="hljs-attr">     stemcell:</span> trusty
<span class="hljs-attr">     networks:</span> [{name: default}]
<span class="hljs-attr">     jobs:</span>
<span class="hljs-attr">     - name:</span> broker-deregistrar
<span class="hljs-attr">       release:</span> msxpert-nipa
<span class="hljs-attr">       properties:</span>
<span class="hljs-attr">         servicebroker:</span>
<span class="hljs-attr">           name:</span> microservicebroker
<span class="hljs-attr">         cf:</span>
<span class="hljs-attr">           api_url:</span> ((cf_api_url))
<span class="hljs-attr">           username:</span> ((cf_username))
<span class="hljs-attr">           password:</span> ((cf_password))
<span class="hljs-attr">           skip_ssl_validation:</span> ((cf_skip_cert_check))

<span class="hljs-attr">   - name:</span> traefik-nipa
<span class="hljs-attr">     instances:</span> <span class="hljs-number">1</span>
<span class="hljs-attr">     azs:</span> [z1]
<span class="hljs-attr">     stemcell:</span> trusty
<span class="hljs-attr">     vm_type:</span> small
   <span class="hljs-comment">#  persistent_disk_type: small</span>
<span class="hljs-attr">     env:</span>
<span class="hljs-attr">       bosh:</span> { swap_size: <span class="hljs-number">0</span> }
<span class="hljs-attr">     networks:</span> [{name: default}]
<span class="hljs-attr">     jobs:</span>
<span class="hljs-attr">       - name:</span> traefik
<span class="hljs-attr">         release:</span> msxpert-nipa
<span class="hljs-attr">         provides:</span>
<span class="hljs-attr">           traefik:</span> {as: haproxy_traefik}
<span class="hljs-attr">         properties:</span>
<span class="hljs-attr">           traefik:</span>
<span class="hljs-attr">             log_level:</span> DEBUG
<span class="hljs-attr">             access_logs:</span> { enabled: <span class="hljs-literal">true</span> }
<span class="hljs-attr">             http:</span> { enabled: <span class="hljs-literal">true</span>, port: ((haproxy_backend_port)) }
<span class="hljs-attr">             web:</span>
<span class="hljs-attr">               enabled:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">               basic_auth:</span>
<span class="hljs-attr">                 username:</span> test
<span class="hljs-attr">                 password:</span> test1234
<span class="hljs-attr">             file:</span>
<span class="hljs-attr">               enabled:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">               watch:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">               rules:</span> <span class="hljs-string">|
                 [frontends]

                   [frontends.frontend1]
                   backend = &quot;backend1&quot;
                     [frontends.frontend1.routes.test_1]
                     rule = &quot;Path:/api/customers&quot;

                 [backends]

                   [backends.backend1]

                       [backends.backend1.servers.server1]
                         url = &quot;http://node.bosh-lite.com&quot;
                         weight = 1

</span><span class="hljs-attr">   - name:</span> grafana-nipa
<span class="hljs-attr">     azs:</span> [z1]
<span class="hljs-attr">     instances:</span> <span class="hljs-number">1</span>
<span class="hljs-attr">     vm_type:</span> small
   <span class="hljs-comment">#  persistent_disk_type: small</span>
<span class="hljs-attr">     stemcell:</span> trusty
<span class="hljs-attr">     networks:</span> [{name: default}]
<span class="hljs-attr">     jobs:</span>
<span class="hljs-attr">       - name:</span> grafana
<span class="hljs-attr">         release:</span> msxpert-nipa
<span class="hljs-attr">         properties:</span>
<span class="hljs-attr">           grafana:</span>
<span class="hljs-attr">             auth:</span>
<span class="hljs-attr">               proxy:</span>
<span class="hljs-attr">                 enabled:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">                 header_name:</span> X-MSXPERTAUTH-USER
<span class="hljs-attr">                 auto_sign_up:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">             security:</span>
<span class="hljs-attr">               admin_user:</span> admin
<span class="hljs-attr">               admin_password:</span> ((grafana_admin_password))

<span class="hljs-attr">     stemcell:</span> trusty
<span class="hljs-attr">     vm_type:</span> small
   <span class="hljs-comment">#  persistent_disk_type: small</span>
<span class="hljs-attr">     env:</span>
<span class="hljs-attr">       bosh:</span> { swap_size: <span class="hljs-number">0</span> }
<span class="hljs-attr">     networks:</span> [{name: default}]

<span class="hljs-attr">   update:</span>
<span class="hljs-attr">     canaries:</span> <span class="hljs-number">1</span>
<span class="hljs-attr">     max_in_flight:</span> <span class="hljs-number">1</span>
<span class="hljs-attr">     serial:</span> <span class="hljs-literal">false</span>
<span class="hljs-attr">     canary_watch_time:</span> <span class="hljs-number">1000</span><span class="hljs-bullet">-60000</span>
<span class="hljs-attr">     update_watch_time:</span> <span class="hljs-number">1000</span><span class="hljs-bullet">-60000</span>
</code></pre>
<p>&lt; vars-file.yml &#xC608;&#xC2DC; &gt;</p>
<pre><code class="lang-yaml"><span class="hljs-bullet">   -</span>--
<span class="hljs-attr">   cf_api_url:</span> https://api.bosh-lite.com <span class="hljs-comment"># [cf api endpoint]</span>
<span class="hljs-attr">   uaa_url:</span> https://uaa.bosh-lite.com
<span class="hljs-attr">   cf_username:</span> admin
<span class="hljs-attr">   cf_password:</span> <span class="hljs-comment"># [CF_Admin_Password]</span>
<span class="hljs-attr">   cf_skip_cert_check:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">   external_url:</span> <span class="hljs-comment"># [studio-nipa VM&#xACFC; &#xC5F0;&#xACB0;&#xC2DC;&#xD0AC; Public IP]:8080</span>
<span class="hljs-attr">   haproxy_backend_port:</span> <span class="hljs-number">8089</span>
<span class="hljs-attr">   grafana_admin_password:</span> admin
</code></pre>
</li>
</ul>
<h3 id="&#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC11C;&#xBE44;&#xC2A4;-&#xC2A4;&#xD29C;&#xB514;&#xC624;-&#xC6B4;&#xC601;">&#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC11C;&#xBE44;&#xC2A4; &#xC2A4;&#xD29C;&#xB514;&#xC624; &#xC6B4;&#xC601;</h3>
<h4 id="trouble-shooting">Trouble Shooting</h4>
<h4 id="contents">Contents</h4>
<blockquote>
<h5 id="msxpert-&#xC758;-db&#xC5D0;-&#xC811;&#xADFC;&#xD558;&#xAE30;"><a href="#msxpert&#xC758;-db&#xC5D0;-&#xC811;&#xADFC;&#xD558;&#xAE30;">MsXpert &#xC758; DB&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xAE30;</a></h5>
<h5 id="msxpert-&#xC0C1;&#xC5D0;&#xC11C;-&#xC571;&#xC758;-url-&#xC8FC;&#xC18C;&#xAC00;-&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C;-&#xC870;&#xD68C;&#xB418;&#xC9C0;-&#xC54A;&#xB294;-&#xACBD;&#xC6B0;"><a href="#msxpert-&#xC0C1;&#xC5D0;&#xC11C;-&#xC571;&#xC758;-url-&#xC8FC;&#xC18C;&#xAC00;-&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C;-&#xC870;&#xD68C;&#xB418;&#xC9C0;-&#xC54A;&#xB294;&#xACBD;&#xC6B0;">MsXpert &#xC0C1;&#xC5D0;&#xC11C; &#xC571;&#xC758; Url &#xC8FC;&#xC18C;&#xAC00; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC870;&#xD68C;&#xB418;&#xC9C0; &#xC54A;&#xB294; &#xACBD;&#xC6B0;</a></h5>
<h5 id="api--&#xB4F1;&#xB85D;&#xC2DC;-restapi&#xAC00;-&#xC870;&#xD68C;&#xB418;&#xC9C0;-&#xC54A;&#xC744;&#xB54C;-restapi-&#xD655;&#xC778;-&#xBC29;&#xBC95;"><a href="#api--&#xB4F1;&#xB85D;&#xC2DC;-restapi&#xAC00;-&#xC870;&#xD68C;&#xB418;&#xC9C0;-&#xC54A;&#xC744;&#xB54C;-restapi-&#xD655;&#xC778;&#xBC29;&#xBC95;">API  &#xB4F1;&#xB85D;&#xC2DC; RestAPI&#xAC00; &#xC870;&#xD68C;&#xB418;&#xC9C0; &#xC54A;&#xC744;&#xB54C; RestAPI &#xD655;&#xC778; &#xBC29;&#xBC95;</a></h5>
<h5 id="cf&#xC5D0;-deploy-&#xB418;&#xC5B4;-&#xC788;&#xB294;-application&#xC758;-env-&#xD655;&#xC778;-&#xBC29;&#xBC95;--application-&#xC811;&#xADFC;-&#xBE44;&#xBC00;&#xBC88;&#xD638;-&#xD655;&#xC778;&#xBC95;"><a href="#cf&#xC5D0;-deploy-&#xB418;&#xC5B4;&#xC788;&#xB294;-application&#xC758;-env-&#xD655;&#xC778;-&#xBC29;&#xBC95;--application-&#xC811;&#xADFC;-&#xBE44;&#xBC00;&#xBC88;&#xD638;-&#xD655;&#xC778;&#xBC95;">cf&#xC5D0; deploy &#xB418;&#xC5B4; &#xC788;&#xB294; application&#xC758; env &#xD655;&#xC778; &#xBC29;&#xBC95; ( Application &#xC811;&#xADFC; &#xBE44;&#xBC00;&#xBC88;&#xD638; &#xD655;&#xC778;&#xBC95;)</a></h5>
<h5 id="spring-cloud-eureka--&#xC5D0;&#xB7EC;"><a href="#spring-cloud-eureka-&#xC5D0;&#xB7EC;">Spring-cloud-Eureka  &#xC5D0;&#xB7EC;</a></h5>
<h5 id="msxpert-nipa&#xC758;-&#xAC01;-instance&#xC5D0;-&#xC811;&#xADFC;&#xD558;&#xB294;-&#xBC29;&#xBC95;"><a href="#msxpert-nipa&#xC758;-&#xAC01;-instance-&#xC5D0;-&#xC811;&#xADFC;&#xD558;&#xB294;-&#xBC29;&#xBC95;">msxpert-nipa&#xC758; &#xAC01; instance&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xB294; &#xBC29;&#xBC95;</a></h5>
<h5 id="&#xB4F1;&#xB85D;&#xB41C;-api&#xAC00;-&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C;-&#xD638;&#xCD9C;&#xB418;&#xC9C0;-&#xC54A;&#xB294;-&#xC0C1;&#xD669;&#xC5D0;&#xC11C;-&#xB300;&#xCC98;&#xBC95;"><a href="#&#xB4F1;&#xB85D;&#xB41C;-api&#xAC00;-&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C;-&#xD638;&#xCD9C;&#xB418;&#xC9C0;-&#xC54A;&#xB294;-&#xC0C1;&#xD669;-&#xB300;&#xCC98;&#xBC95;">&#xB4F1;&#xB85D;&#xB41C; API&#xAC00; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xB418;&#xC9C0; &#xC54A;&#xB294; &#xC0C1;&#xD669;&#xC5D0;&#xC11C; &#xB300;&#xCC98;&#xBC95;</a></h5>
</blockquote>
<h5 id="msxpert&#xC758;-db&#xC5D0;-&#xC811;&#xADFC;&#xD558;&#xAE30;">MsXpert&#xC758; DB&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xAE30;</h5>
<pre><code class="lang-shell">      # bosh Inception&#xC5D0;&#xC11C; &#xC544;&#xB798;&#xC758; &#xACFC;&#xC815;&#xC744; &#xC2E4;&#xD589;
      $ bosh envs
      # &#xC608;&#xC2DC; &#xACB0;&#xACFC;: url: 10.10.1.10,  Alias: bosh_dev

      # vm &#xD655;&#xC778;
      $ bosh -e bosh_dev vms  
      # Deployment &apos;msxpert-nipa&apos;&#xC758; &apos;db-nipa&apos; vm&#xC5D0;  bosh ssh &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xC5EC; &#xC811;&#xC18D;
      $ bosh -e bosh_dev -d msxpert-nipa ssh db-nipa

      # bosh &#xBA85;&#xB839;&#xC5B4; &#xC0AC;&#xC6A9;&#xC2DC; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xC5D0;&#xB7EC;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xBA74; bosh login &#xC744; &#xC2E4;&#xD589;&#xD558;&#xC5EC; &#xD574;&#xACB0;
      # refreshing token: Refreshing token: UAA responded with non-successful status code &apos;401&apos; response &apos;{&quot;error&quot;:&quot;invalid_token&quot;,&quot;error_description&quot;:&quot;Invalid refresh token expired at Wed Feb 26 07:07:41 UTC 2020&quot;}&apos;

      # bosh login&#xC744; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC9C4;&#xD589;&#xD5C0;&#xC74C;&#xC5D0;&#xB3C4; &#xAC19;&#xC740; &#xC624;&#xB958;&#xAC00; &#xBC1C;&#xC0DD;&#xD55C;&#xB2E4;&#xBA74; bosh &#xBA85;&#xB839;&#xC5B4; &#xB0B4;&#xB9B4;&#xB54C; auth &#xC815;&#xBCF4;&#xB97C; &#xBD80;&#xC5EC;
      # &#xC608;&#xC2DC; $ bosh -e bosh_dev --client [&#xACC4;&#xC815;] --client-secret [&#xBE44;&#xBC00;&#xBC88;&#xD638;] vms

      # ssh &#xC811;&#xC18D; &#xC774;&#xD6C4;&#xC5D0;&#xB294; &#xC544;&#xB798;&#xC758; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD1B5;&#xD574; DB&#xC5D0; &#xC811;&#xADFC;&#xC774; &#xAC00;&#xB2A5;
      $ sudo -u vcap /var/vcap/packages/postgres-9.6.4/bin/psql microservice-nipa
</code></pre>
<h5 id="msxpert-&#xC0C1;&#xC5D0;&#xC11C;-&#xC571;&#xC758;-url-&#xC8FC;&#xC18C;&#xAC00;-&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C;-&#xC870;&#xD68C;&#xB418;&#xC9C0;-&#xC54A;&#xB294;&#xACBD;&#xC6B0;">MsXpert &#xC0C1;&#xC5D0;&#xC11C; &#xC571;&#xC758; Url &#xC8FC;&#xC18C;&#xAC00; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC870;&#xD68C;&#xB418;&#xC9C0; &#xC54A;&#xB294;&#xACBD;&#xC6B0;</h5>
<ul>
<li><p>backendApp&#xC740; &#xBCF4;&#xC548;&#xC744; &#xC704;&#xD574;&#xC11C; url&#xC774; &#xACF5;&#xAC1C; &#xB418;&#xC9C0; &#xC54A;&#xB294; &#xAC83;&#xC774; &#xAE30;&#xBCF8; Setting
<img src="technicalReportImages/msxpert_url_check.png" alt=""></p>
<pre><code class="lang-shell">  # &#xC608;&#xC2DC; cf target &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD1B5;&#xD574; &#xC791;&#xC5C5; &#xACF5;&#xAC04;&#xC744; &#xC124;&#xC815;&#xD574;&#xB454; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; cf map-route &#xBA85;&#xB839;&#xC5B4; &#xC2E4;&#xD589;
  # api endpoint:   https://api.bosh-lite.com
  # api version:    2.121.0
  # user:           test
  # org:            test-org
  # space:          space
  $ cf map-route crs-front-lkop bosh-lite.com --hostname crs-front-lkop
</code></pre>
</li>
</ul>
<h5 id="api--&#xB4F1;&#xB85D;&#xC2DC;-restapi&#xAC00;-&#xC870;&#xD68C;&#xB418;&#xC9C0;-&#xC54A;&#xC744;&#xB54C;-restapi-&#xD655;&#xC778;&#xBC29;&#xBC95;">API  &#xB4F1;&#xB85D;&#xC2DC; RestAPI&#xAC00; &#xC870;&#xD68C;&#xB418;&#xC9C0; &#xC54A;&#xC744;&#xB54C; RestAPI &#xD655;&#xC778;&#xBC29;&#xBC95;</h5>
<ul>
<li><p>&#xC6B0;&#xC120;&#xC801;&#xC73C;&#xB85C; swagger&#xD398;&#xC774;&#xC9C0;&#xAC00; &#xC815;&#xC0C1; &#xB3D9;&#xC791;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;
<img src="technicalReportImages/api_registry_NoAPI.png" alt=""></p>
<pre><code class="lang-shell">  # &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xB97C; &#xD1B5;&#xD574; http://[ &#xD655;&#xC778;&#xD558;&#xACE0; &#xC2F6;&#xC740; Application URL ]/swagger-ui.html &#xC811;&#xC18D; &#xD6C4; &#xD655;&#xC778;&#xD558;&#xACE0; &#xC2F6;&#xC740; &#xCEE8;&#xD2B8;&#xB864;&#xB7EC; &#xD074;&#xB9AD;
  # &#xC0AC;&#xC9C4; &#xC608;&#xC2DC;: http://crs-front-lkop.bosh-lite.com/swagger-ui.html

  # &#xC774; &#xBD80;&#xBD84;&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xB418;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xCF54;&#xB4DC;&#xB97C; &#xD655;&#xC778;
  # &apos;microservice-nipa&apos; DB&#xC758; &apos;micro_app&apos; &#xD14C;&#xC774;&#xBE14; &#xD56D;&#xBAA9;&#xC5D0;&#xC11C; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xB370;&#xC774;&#xD130;&#xC758; swagger &#xB370;&#xC774;&#xD130;&#xC5D0; &apos;&apos;(&#xBE48; &#xAC12;)&#xC744; &#xB123;&#xC5B4;&#xC8FC;&#xC5B4; DB&#xC5D0; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xB370;&#xC774;&#xD130;&#xAC00; &#xCC44;&#xC6CC;&#xC9C0;&#xAC8C; &#xD568;.
  # &#xD574;&#xB2F9; &#xC791;&#xC5C5; &#xC774;&#xD6C4;&#xC5D0;&#xB3C4; &#xBB38;&#xC81C;&#xAC00; &#xBC1C;&#xC0DD;&#xD55C;&#xB2E4;&#xBA74; Application &#xCABD;&#xC5D0;&#xC11C; swagger&#xBD80;&#xBD84; &#xCF54;&#xB4DC;&#xB97C; &#xD655;&#xC778;&#xD574;&#xC57C;&#xD568;.
</code></pre>
<p> <img src="technicalReportImages/swagger-api-check.png" alt=""></p>
</li>
</ul>
<h5 id="cf&#xC5D0;-deploy-&#xB418;&#xC5B4;&#xC788;&#xB294;-application&#xC758;-env-&#xD655;&#xC778;-&#xBC29;&#xBC95;--application-&#xC811;&#xADFC;-&#xBE44;&#xBC00;&#xBC88;&#xD638;-&#xD655;&#xC778;&#xBC95;">cf&#xC5D0; deploy &#xB418;&#xC5B4;&#xC788;&#xB294; application&#xC758; env &#xD655;&#xC778; &#xBC29;&#xBC95; ( Application &#xC811;&#xADFC; &#xBE44;&#xBC00;&#xBC88;&#xD638; &#xD655;&#xC778;&#xBC95;)</h5>
<pre><code class="lang-shell">      # cf env [ Application &#xC774;&#xB984; ]
      $ cf env configapp508a6971-870b-45a7-a4df-ac94f5d54987

      # application&#xC758; basic auth &#xC815;&#xBCF4;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC74C;.
      # &#xACB0;&#xACFC; &#xC608;&#xC2DC;
      #Getting env variables for app configapp508a6971-870b-45a7-a4df-ac94f5d54987 in org user3-org / space space as user3...
      #OK

      System-Provided:
      {
       &quot;VCAP_APPLICATION&quot;: {
        &quot;application_id&quot;: &quot;e10ad7e7-d401-404e-af77-7547c3ab3ecd&quot;,
        &quot;application_name&quot;: &quot;configapp508a6971-870b-45a7-a4df-ac94f5d54987&quot;,
        &quot;application_uris&quot;: [
         &quot;configapp508a6971-870b-45a7-a4df-ac94f5d54987.bosh-lite.com&quot;
        ],
        &quot;application_version&quot;: &quot;c2384821-37d1-4c91-913f-3d3a24f34005&quot;,
        &quot;cf_api&quot;: &quot;https://api.bosh-lite.com&quot;,
        &quot;limits&quot;: {
         &quot;disk&quot;: 1024,
         &quot;fds&quot;: 16384,
         &quot;mem&quot;: 1024
        },
        &quot;name&quot;: &quot;configapp508a6971-870b-45a7-a4df-ac94f5d54987&quot;,
        &quot;space_id&quot;: &quot;c5914e3f-8716-46cc-9a54-3c1020bb27dd&quot;,
        &quot;space_name&quot;: &quot;space&quot;,
        &quot;uris&quot;: [
         &quot;configapp508a6971-870b-45a7-a4df-ac94f5d54987.bosh-lite.com&quot;
        ],
        &quot;users&quot;: null,
        &quot;version&quot;: &quot;c2384821-37d1-4c91-913f-3d3a24f34005&quot;
       }
      }
      User-Provided:
      basic-secret: 76e0a~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      basic-user: 508a6971-870b-45a7-a4df-ac94f5d54987
</code></pre>
<ul>
<li><p>basic auth &#xC0AC;&#xC6A9; &#xC608;&#xC2DC;1) cf env&#xB97C; &#xD1B5;&#xD574; &#xD655;&#xC778;&#xD55C; basic auth &#xC815;&#xBCF4;&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xC5EC; application&#xC5D0; &#xC811;&#xADFC; &#xAC00;&#xB2A5;
  <img src="technicalReportImages/cf_env_auth.png" alt=""></p>
</li>
<li><p>basic auth &#xC0AC;&#xC6A9; &#xC608;&#xC2DC;2) </p>
<pre><code class="lang-shell">  # curl &#xBA85;&#xB839; &#xC0AC;&#xC6A9; 
  # config application refresh
  $ curl -d {} -u 508a6971-870b-45a7-a4df-ac94f5d54987:76e0a~~~~~~~~~~~~~~~~~~~~~~~~~~~~~   configapp508a6971-870b-45a7-a4df-ac94f5d54987.bosh-lite.com/refresh
</code></pre>
</li>
</ul>
<h5 id="spring-cloud-eureka-&#xC5D0;&#xB7EC;">Spring-cloud-Eureka &#xC5D0;&#xB7EC;</h5>
<pre><code class="lang-shell">      # EMERGENCY! EUREKA MAY BE INCORRECTLY CLAIMING INSTANCES ARE UP WHEN THEY&apos;RE NOT. RENEWALS ARE LESSER THAN THRESHOLD AND HENCE THE INSTANCES ARE NOT BEING EXPIRED JUST TO BE SAFE.

      # Renews threshold&#xAC12;&#xC774; Renews(last min) &#xBCF4;&#xB2E4; &#xD06C;&#xBA74; spring-cloud-config &#xC571;&#xC774; &#xC7AC;&#xC2DC;&#xC791;&#xD55C; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; spring-cloud-eureka&#xB97C; &#xC7AC;&#xC2DC;&#xC791;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC774; &#xD544;&#xC694;
</code></pre>
<p> <img src="technicalReportImages/spring-cloud-eureka-error.png" alt=""></p>
<h5 id="msxpert-nipa&#xC758;-&#xAC01;-instance-&#xC5D0;-&#xC811;&#xADFC;&#xD558;&#xB294;-&#xBC29;&#xBC95;">msxpert-nipa&#xC758; &#xAC01; instance &#xC5D0; &#xC811;&#xADFC;&#xD558;&#xB294; &#xBC29;&#xBC95;</h5>
<pre><code class="lang-shell">      # msxpert-nipa&#xC758; deploy &#xC0C1;&#xD669;&#xC774; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC744;&#xB54C; &#xAC01; instance&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xB294; &#xBC29;&#xBC95;
      # Deployment &apos;msxpert-nipa&apos;

      # Instance                                           Process State  AZ  IPs  
      # db-nipa/cad4df9b-05af-4c61-8aa6-46494b6972e3       running        z1  10.10.20.152
      # grafana-nipa/6ac55edb-dc2d-4ee4-b7c9-62ac3d2d0f70  running        z1  10.10.20.154
      # studio-nipa/4d9d4f20-cdb3-4dce-8631-977952110404   running        z1  10.10.20.151
      # traefik-nipa/2dccbac6-4840-4ad6-bb8a-cf181466ecd7  running        z1  10.10.20.153
      # 4 vms
</code></pre>
<ul>
<li><p>&#xCCAB;&#xBC88;&#xC9F8; &#xBC29;&#xBC95;: IaaS&#xC5D0;&#xC11C; &#xC0DD;&#xC131;&#xD55C; public IP(Floating IP)&#xC5D0; &#xD574;&#xB2F9; vm &#xACB0;&#xD569;</p>
</li>
<li><p>&#xB450;&#xBC88;&#xC9F8; &#xBC29;&#xBC95;:  haproxy&#xC0AC;&#xC6A9;</p>
<pre><code class="lang-shell">    # haproxy &#xC124;&#xCE58;
    $ sudo apt install haproxy
    # haproxy &#xC124;&#xCE58; &#xD655;&#xC778;
    $ sudo systemctl status haproxy
    # haproxy.cfg &#xC218;&#xC815;
    $ sudo vi /etc/haproxy/haproxy.cfg 

    ### &#xC218;&#xC815; &#xC608;&#xC2DC; ###
    # frontend studio-trafik
    # bind *:9088
    # option forwardfor
    # default_backend traefik-back

    # backend traefik-back
    # balance roundrobin
    # server webserver5 10.10.20.153:8080
    # option httpchk

    # haproxy &#xC7AC;&#xC2DC;&#xC791;
    $ sudo systemctl restart haproxy

    # &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xB97C; &#xD1B5;&#xD574; &#xC811;&#xC18D; 
    # haproxy&#xB97C; &#xB3D9;&#xC791;&#xC2DC;&#xD0A8; vm&#xC758; IP&#xAC00; 10.10.0.1&#xC774;&#xB77C;&#xBA74; studio-traefik &#xC811;&#xADFC; URL&#xC740; 10.10.0.1:9088
</code></pre>
<p>&lt; &#xC811;&#xC18D; &#xD654;&#xBA74; &gt;
<img src="technicalReportImages/Traefik-haproxy.png" alt=""></p>
</li>
</ul>
<h5 id="&#xB4F1;&#xB85D;&#xB41C;-api&#xAC00;-&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C;-&#xD638;&#xCD9C;&#xB418;&#xC9C0;-&#xC54A;&#xB294;-&#xC0C1;&#xD669;-&#xB300;&#xCC98;&#xBC95;">&#xB4F1;&#xB85D;&#xB41C; API&#xAC00; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xB418;&#xC9C0; &#xC54A;&#xB294; &#xC0C1;&#xD669; &#xB300;&#xCC98;&#xBC95;</h5>
<p> <img src="technicalReportImages/API_page_not_found.png" alt=""></p>
<p>  &lt; &#xC0C1;&#xD669;1. API &#xD638;&#xCD9C;&#xC2DC; &#xC5D0;&#xB7EC; &gt;
 <img src="technicalReportImages/Traefik_vms_running.png" alt=""></p>
<p>  &lt; &#xC0C1;&#xD669;2. vm&#xC0C1; &#xD655;&#xC778;&#xC2DC; traefik &#xC815;&#xC0C1; &#xB3D9;&#xC791; &gt;
 <img src="technicalReportImages/Traefik_no_web.png" alt=""></p>
<p>  &lt; &#xC0C1;&#xD669;3. Traefik &#xD654;&#xBA74;&#xC5D0;&#xC11C; web &#xD0DC;&#xADF8; &#xD655;&#xC778;&#xC774; &#xC548;&#xB420;&#xB54C; &gt;
  <img src="technicalReportImages/Traefik_web_tag.png" alt=""></p>
<p>  &lt; &#xC0C1;&#xD669;3 &#xBE44;&#xAD50;. Traefik &#xD654;&#xBA74;&#xC5D0;&#xC11C; web &#xD0DC;&#xADF8;&#xAC00; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xD655;&#xC778; &gt;</p>
<pre><code class="lang-shell">      #&#xC0C1;&#xD669; 1, 2, 3 &#xC774; &#xB3D9;&#xC2DC;&#xC5D0; &#xD655;&#xC778;&#xB418;&#xB294; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; Traefik &#xC774; &#xB2E4;&#xC2DC; &#xC62C;&#xB77C;&#xAC04; &#xACBD;&#xC6B0;&#xB77C;&#xACE0; &#xBCF4;&#xACE0; &#xC0C8;&#xB85C; API&#xB97C; &#xB4F1;&#xB85D;&#xD574;&#xC8FC;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xD574;&#xACB0; &#xAC00;&#xB2A5;&#xD568;. API&#xB4F1;&#xB85D;&#xC740; API&#xAD00;&#xB9AC;&#xB098; &#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC11C;&#xBE44;&#xC2A4; &#xD3B8;&#xC9D1;&#xC5D0;&#xC11C; &#xC2DC;&#xB3C4;.
</code></pre>
<h3 id="msxpert-reference">MsXpert Reference</h3>
<h4 id="database-&#xAD6C;&#xC870;">Database &#xAD6C;&#xC870;</h4>
<ul>
<li><p>DB &#xD14C;&#xC774;&#xBE14; reference</p>
<ul>
<li>&#xD30C;&#xB780;&#xC0C9;: micro_app&#xC758; id</li>
<li>&#xBE68;&#xAC04;&#xC0C9;: micro_api&#xC758; id</li>
</ul>
</li>
<li><p>micro_app: MsXpert&#xC5D0;&#xC11C; &#xC0DD;&#xC131;&#xD55C; &#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC11C;&#xBE44;&#xC2A4;</p>
<p><img src="technicalReportImages/db_micro_app.png" alt=""></p>
</li>
<li><p>micro_app_service: &#xAC01;&#xAC01;&#xC758; &#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC11C;&#xBE44;&#xC2A4;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xB294; cf&#xC0C1;&#xC758; service (config-service, registry-service)</p>
<p><img src="technicalReportImages/db_micro_app_service.png" alt=""></p>
</li>
<li><p>micro_app_app: &#xAC01;&#xAC01;&#xC758; &#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xAD6C;&#xC131;&#xD558;&#xACE0; &#xC788;&#xB294; cf&#xC0C1;&#xC758; application</p>
<p><img src="technicalReportImages/db_micro_app_app.png" alt=""></p>
</li>
<li><p>micro_api: MsXpert&#xC5D0; &#xACF5;&#xAC1C;&#xB418;&#xC5B4; &#xC788;&#xB294; API</p>
<p><img src="technicalReportImages/db_micro_api.png" alt=""></p>
</li>
<li><p>micro_api_frontend: micro_app&#xACFC; micro_api&#xC758; &#xAD00;&#xACC4; &#xD655;&#xC778; &#xAC00;&#xB2A5;, &#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC11C;&#xBE44;&#xC2A4; API &#xC0DD;&#xC131;&#xC2DC; Update</p>
<p><img src="technicalReportImages/db_micro_api_frontend.png" alt=""></p>
</li>
<li><p>micro_app_api: &#xAC01;&#xAC01;&#xC758; &#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC11C;&#xBE44;&#xC2A4;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xB294; micro_api</p>
<p><img src="technicalReportImages/db_micro_app_api.png" alt=""></p>
</li>
<li><p>micro_api_rule: traefik&#xC11C;&#xBC84;&#xC5D0;&#xC11C; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xC788;&#xB294; micro_api&#xB4E4;&#xC758; &#xC815;&#xBCF4;, micro_app_api&#xC5D0; &#xAD00;&#xD55C; &#xB0B4;&#xC6A9;&#xB3C4; &#xD655;&#xC778; &#xAC00;&#xB2A5;</p>
<p><img src="technicalReportImages/db_micro_api_rule.png" alt=""></p>
</li>
<li><p>migration_version: Database-migration &#xC815;&#xBCF4;,  Database Connection &#xC0DD;&#xC131;&#xC2DC; &#xC0AC;&#xC6A9;</p>
<p><img src="technicalReportImages/db_migration_version.png" alt=""></p>
</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="openapi_manager.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: 오픈데이터API 제공처 메뉴얼">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"MSA Technical Report","level":"6.1","depth":1,"previous":{"title":"오픈데이터API 제공처 메뉴얼","level":"5.3","depth":1,"path":"openapi_manager.md","ref":"openapi_manager.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{"BASE_URL":"https://startupcloudplatform.github.io/cloud4dev-docs/"},"plugins":["ga"],"pluginsConfig":{"ga":{"configuration":"auto","token":"GA 토큰값, 예시 : UA-123456-1"},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"Technical_Report.md","mtime":"2020-10-15T09:06:49.415Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-10-16T06:29:45.054Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

